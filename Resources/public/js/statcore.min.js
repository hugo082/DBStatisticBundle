function loadGraph(a){var t=$("div[data-id='"+a.status.graph_id+"']");if(a.status.code===200){var r="elm_"+a.graph.informations.id;$("<canvas>").attr({id:r}).appendTo(t);insertActions(a.graph,t);showGraph(a.graph,r)}else{t.append("<h3 class='graph-error graph-error-title'>Error Loading Graph</h3>");t.append("<p class='graph-error graph-error-desc'>"+a.status.title+"</p>");console.error(a.status.message)}}function multipleRequestGraph(a){$.ajax({url:"/statistic/data/multiple",data:a,success:function(a){for(var t in a.graphs)loadGraph(a.graphs[t])}})}function requestGraph(a){$.ajax({url:"/statistic/data/"+a,data:null,success:loadGraph})}function showGraph(a,t){window["graphs"][a.informations.id]=new Chart(t,{type:a.informations.type,data:a.data,options:a.options})}function updateGraph(a,t){$.ajax({url:"/statistic/data/"+a,data:t,success:function(t){var r=window["graphs"][a];if(typeof r==="undefined"){console.error("Impossible to find chart with id : "+a);return}if(t.status.code===200){r.data.labels=t.graph.data.labels;r.data.datasets=t.graph.data.datasets;r.update()}else console.error(t.status.message)}})}function insertActions(a,t){var r=$("<div>").attr({class:"actions-container"}).prependTo(t);for(var i=0;i<a.actions.length;i++){var e=a.actions[i];$("<button>").text(e.title).prependTo(r).data("id",a.informations.id).data("action",e).click(function(){var a=$(this).data();updateGraph(a.id,a.action)})}}var graphs=$("div[data-type='graph']");var multiple={};graphs.each(function(a){var t=$(this).data("multiple");if(typeof t!=="undefined"){if(typeof multiple[t]==="undefined")multiple[t]={};multiple[$(this).data("multiple")]["id"+a]=$(this).data("id")}else requestGraph($(this).data("id"))});for(var graphSet in multiple){multipleRequestGraph(multiple[graphSet])}